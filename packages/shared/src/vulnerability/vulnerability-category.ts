/**
 * Vulnerability Category Types
 *
 * Categorizes vulnerability mode toggles by functional area for organized
 * display and educational purposes.
 *
 * @module vulnerability/vulnerability-category
 */

/**
 * Vulnerability Category
 *
 * Groups related vulnerability toggles by OAuth2/OIDC functional area.
 * Used for organizing vulnerability mode UI and educational content.
 */
export enum VulnerabilityCategory {
  /**
   * Authorization Endpoint Vulnerabilities
   *
   * Vulnerabilities in the authorization request and response:
   * - PKCE bypass (DISABLE_PKCE)
   * - State parameter issues
   * - Redirect URI validation
   *
   * RFC 6749 Section 3.1 (Authorization Endpoint)
   * RFC 7636 (PKCE)
   */
  AUTHORIZATION_ENDPOINT = 'authorization_endpoint',

  /**
   * Token Endpoint Vulnerabilities
   *
   * Vulnerabilities in token request and response:
   * - Client authentication bypass
   * - PKCE validation bypass
   * - Token response manipulation
   *
   * RFC 6749 Section 3.2 (Token Endpoint)
   */
  TOKEN_ENDPOINT = 'token_endpoint',

  /**
   * Token Validation Vulnerabilities
   *
   * Vulnerabilities in JWT token validation:
   * - Signature verification bypass
   * - Expiration check bypass
   * - Issuer/audience validation bypass
   * - at_hash/c_hash bypass (OIDC)
   *
   * RFC 7519 (JWT)
   * OIDC Core Section 3.1.3.7 (ID Token Validation)
   */
  TOKEN_VALIDATION = 'token_validation',

  /**
   * Client Authentication Vulnerabilities
   *
   * Vulnerabilities in client authentication:
   * - Client secret bypass
   * - Weak client secrets
   * - Client credentials in query parameters
   *
   * RFC 6749 Section 2.3 (Client Authentication)
   */
  CLIENT_AUTHENTICATION = 'client_authentication',

  /**
   * State/CSRF Vulnerabilities
   *
   * Vulnerabilities in CSRF protection:
   * - State parameter disabled
   * - Predictable state values
   * - State validation bypass
   *
   * RFC 6749 Section 10.12 (CSRF)
   */
  STATE_CSRF = 'state_csrf',

  /**
   * Redirect URI Vulnerabilities
   *
   * Vulnerabilities in redirect URI handling:
   * - Lax redirect URI matching
   * - Open redirect vulnerabilities
   * - Pattern-based URI matching
   *
   * RFC 6749 Section 3.1.2 (Redirect URI)
   * Security BCP Section 4.1 (Redirect URI Validation)
   */
  REDIRECT_URI = 'redirect_uri',

  /**
   * Transport Security Vulnerabilities
   *
   * Vulnerabilities in transport layer security:
   * - HTTP instead of HTTPS
   * - Certificate validation bypass
   * - Insecure TLS versions
   *
   * RFC 6749 Section 3.1 (TLS Required)
   */
  TRANSPORT_SECURITY = 'transport_security',

  /**
   * Token Binding Vulnerabilities
   *
   * Vulnerabilities in sender-constrained tokens:
   * - DPoP disabled
   * - Token reuse allowed
   * - mTLS disabled
   *
   * RFC 9449 (DPoP)
   * RFC 8705 (mTLS)
   */
  TOKEN_BINDING = 'token_binding',

  /**
   * Token Leakage Vulnerabilities
   *
   * Vulnerabilities that expose tokens:
   * - Tokens in URL fragments
   * - Tokens in browser history
   * - Unencrypted token storage
   *
   * Security BCP Section 4.2.4 (Token Leakage)
   */
  TOKEN_LEAKAGE = 'token_leakage',

  /**
   * Scope Handling Vulnerabilities
   *
   * Vulnerabilities in OAuth2 scope handling:
   * - Scope validation bypass
   * - Scope escalation allowed
   *
   * RFC 6749 Section 3.3 (Access Token Scope)
   */
  SCOPE_HANDLING = 'scope_handling',

  /**
   * Refresh Token Vulnerabilities
   *
   * Vulnerabilities in refresh token handling:
   * - Refresh token rotation disabled
   * - Reusable refresh tokens
   * - Refresh token binding bypass
   *
   * RFC 6749 Section 1.5 (Refresh Tokens)
   * Security BCP Section 4.13 (Refresh Token Protection)
   */
  REFRESH_TOKEN = 'refresh_token',

  /**
   * UI/UX Security Vulnerabilities
   *
   * Vulnerabilities in user interface and experience:
   * - Clickjacking (iframe allowed)
   * - CORS disabled
   * - Mixed content allowed
   *
   * RFC 6749 Section 10.13 (Clickjacking)
   */
  UI_UX_SECURITY = 'ui_ux_security',
}

/**
 * Vulnerability Category Metadata
 *
 * Provides display information and descriptions for each category.
 *
 * @example
 * ```typescript
 * const metadata: VulnerabilityCategoryMetadata = {
 *   category: VulnerabilityCategory.AUTHORIZATION_ENDPOINT,
 *   name: 'Authorization Endpoint',
 *   description: 'Vulnerabilities in the OAuth2 authorization request',
 *   icon: 'lock-open'
 * };
 * ```
 */
export interface VulnerabilityCategoryMetadata {
  /**
   * Category identifier
   */
  category: VulnerabilityCategory;

  /**
   * Human-readable category name
   *
   * Used in UI for display
   */
  name: string;

  /**
   * Category description
   *
   * Explains what types of vulnerabilities are in this category
   */
  description: string;

  /**
   * Icon identifier for UI display (optional)
   *
   * Example: 'lock-open', 'shield-alert', 'key'
   */
  icon?: string;
}

/**
 * Category Metadata Registry
 *
 * Provides metadata for all vulnerability categories.
 * MVP includes 6 categories, with additional categories for Phase 2/3.
 */
export const CATEGORY_METADATA: Record<VulnerabilityCategory, VulnerabilityCategoryMetadata> = {
  [VulnerabilityCategory.AUTHORIZATION_ENDPOINT]: {
    category: VulnerabilityCategory.AUTHORIZATION_ENDPOINT,
    name: 'Authorization Endpoint',
    description: 'Vulnerabilities in authorization request flow including PKCE, state, and redirect URI',
    icon: 'lock-open',
  },

  [VulnerabilityCategory.TOKEN_ENDPOINT]: {
    category: VulnerabilityCategory.TOKEN_ENDPOINT,
    name: 'Token Endpoint',
    description: 'Vulnerabilities in token exchange including client authentication and validation',
    icon: 'key',
  },

  [VulnerabilityCategory.TOKEN_VALIDATION]: {
    category: VulnerabilityCategory.TOKEN_VALIDATION,
    name: 'Token Validation',
    description: 'Vulnerabilities in JWT token validation including signature, expiration, and claims',
    icon: 'shield-alert',
  },

  [VulnerabilityCategory.STATE_CSRF]: {
    category: VulnerabilityCategory.STATE_CSRF,
    name: 'CSRF Protection',
    description: 'Vulnerabilities in Cross-Site Request Forgery protection using state parameter',
    icon: 'alert-triangle',
  },

  [VulnerabilityCategory.REDIRECT_URI]: {
    category: VulnerabilityCategory.REDIRECT_URI,
    name: 'Redirect URI Validation',
    description: 'Vulnerabilities in redirect URI validation including open redirects',
    icon: 'external-link',
  },

  [VulnerabilityCategory.TRANSPORT_SECURITY]: {
    category: VulnerabilityCategory.TRANSPORT_SECURITY,
    name: 'Transport Security',
    description: 'Vulnerabilities in HTTPS/TLS including certificate validation',
    icon: 'shield-off',
  },

  // Phase 2/3 categories with basic metadata
  [VulnerabilityCategory.CLIENT_AUTHENTICATION]: {
    category: VulnerabilityCategory.CLIENT_AUTHENTICATION,
    name: 'Client Authentication',
    description: 'Vulnerabilities in client authentication mechanisms',
    icon: 'user-x',
  },

  [VulnerabilityCategory.TOKEN_BINDING]: {
    category: VulnerabilityCategory.TOKEN_BINDING,
    name: 'Token Binding',
    description: 'Vulnerabilities in sender-constrained tokens (DPoP, mTLS)',
    icon: 'link-2',
  },

  [VulnerabilityCategory.TOKEN_LEAKAGE]: {
    category: VulnerabilityCategory.TOKEN_LEAKAGE,
    name: 'Token Leakage',
    description: 'Vulnerabilities that expose tokens to unauthorized parties',
    icon: 'eye-off',
  },

  [VulnerabilityCategory.SCOPE_HANDLING]: {
    category: VulnerabilityCategory.SCOPE_HANDLING,
    name: 'Scope Handling',
    description: 'Vulnerabilities in OAuth2 scope validation and escalation',
    icon: 'layers',
  },

  [VulnerabilityCategory.REFRESH_TOKEN]: {
    category: VulnerabilityCategory.REFRESH_TOKEN,
    name: 'Refresh Tokens',
    description: 'Vulnerabilities in refresh token handling and rotation',
    icon: 'refresh-cw',
  },

  [VulnerabilityCategory.UI_UX_SECURITY]: {
    category: VulnerabilityCategory.UI_UX_SECURITY,
    name: 'UI/UX Security',
    description: 'Vulnerabilities in user interface security (clickjacking, CORS)',
    icon: 'monitor',
  },
};
