# Visualization Requirements - Security Features
## Security Mechanism Visualization Specifications

> *"Security is invisible when it works, visible when it doesn't."*

---

## Document Information

| Property | Value |
|----------|-------|
| **Document Type** | UI/UX Requirements |
| **Target Audience** | Frontend developers implementing security visualizations |
| **Purpose** | Define visualization for OAuth2/OIDC security mechanisms |
| **Related Docs** | PKCE, state, JWT, redirect URI validation docs |
| **Part** | 3 of 6 (Security Features) |

---

## 1. PKCE Visualization

### 1.1 PKCE Overview Panel

**Purpose**: Explain PKCE at a glance

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PKCE (Proof Key for Code Exchange)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Status: âœ“ ENABLED (S256)                                   â”‚
â”‚                                                              â”‚
â”‚  Purpose: Binds authorization code to the client that       â”‚
â”‚           requested it, preventing code interception        â”‚
â”‚                                                              â”‚
â”‚  Method: S256 (SHA-256 hash)                                â”‚
â”‚  RFC: 7636                                                  â”‚
â”‚                                                              â”‚
â”‚  [View PKCE Process] [Show Attack Demo]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Code Verifier Generation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: Generate Code Verifier                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Random Generation:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Source: Cryptographically secure random number   â”‚    â”‚
â”‚  â”‚          generator (CSPRNG)                        â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  Entropy: 256 bits                                 â”‚    â”‚
â”‚  â”‚  [========================================] 100%    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  Code Verifier (Base64URL encoded):                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk       â”‚    â”‚
â”‚  â”‚                                         [Copy]     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  Properties:                                                â”‚
â”‚  â€¢ Length: 43 characters (43-128 allowed)                   â”‚
â”‚  â€¢ Character set: [A-Z] [a-z] [0-9] - _ . ~                â”‚
â”‚  â€¢ Base64URL: URL-safe encoding                             â”‚
â”‚  â€¢ Single-use: Used once per authorization                  â”‚
â”‚                                                              â”‚
â”‚  Storage:                                                   â”‚
â”‚  âœ“ Stored securely in memory                                â”‚
â”‚  âœ“ Never sent to authorization server yet                   â”‚
â”‚  âœ“ Will be sent during token exchange                       â”‚
â”‚                                                              â”‚
â”‚  [Regenerate] [View Spec Requirements]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 Code Challenge Calculation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: Calculate Code Challenge                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Transformation: code_verifier â†’ code_challenge             â”‚
â”‚                                                              â”‚
â”‚  Input (Code Verifier):                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                   â”‚
â”‚                          â”‚ Apply SHA-256 hash               â”‚
â”‚                          â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Binary Hash (32 bytes):                           â”‚    â”‚
â”‚  â”‚  t6fdqQm4uU7DybR3LEgG5gmPvd9DIejV...              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                   â”‚
â”‚                          â”‚ Base64URL encode                 â”‚
â”‚                          â–¼                                   â”‚
â”‚  Output (Code Challenge):                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM       â”‚    â”‚
â”‚  â”‚                                         [Copy]     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  Method: S256                                               â”‚
â”‚  â„¹ï¸ S256 = SHA-256 hash + Base64URL encoding                â”‚
â”‚                                                              â”‚
â”‚  This challenge will be sent to authorization server        â”‚
â”‚  The verifier will be sent during token exchange            â”‚
â”‚                                                              â”‚
â”‚  ğŸ”’ Security: Server cannot reverse the hash to get verifierâ”‚
â”‚               Only client with verifier can complete flow   â”‚
â”‚                                                              â”‚
â”‚  [View SHA-256 Details] [Compare Plain vs S256]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.4 PKCE in Authorization Request

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3: Send Code Challenge in Authorization Request      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Authorization Request Parameters:                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Parameter            â”‚ Value                      â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ code_challenge       â”‚ E9Melhoa2OwvFrEMTJguc...  â”‚     â”‚
â”‚  â”‚                      â”‚ âœ“ SHA-256 hash of verifier â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ code_challenge_methodâ”‚ S256                       â”‚     â”‚
â”‚  â”‚                      â”‚ âœ“ Specifies hash method    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚  Server Actions:                                            â”‚
â”‚  1. âœ“ Receive code_challenge and method                     â”‚
â”‚  2. âœ“ Store challenge with authorization code               â”‚
â”‚  3. âœ“ Bind challenge to code (cannot be changed)            â”‚
â”‚                                                              â”‚
â”‚  Client Actions:                                            â”‚
â”‚  1. âœ“ Store code_verifier securely (in memory)              â”‚
â”‚  2. âœ“ Keep verifier secret (never log or expose)            â”‚
â”‚  3. âœ“ Send verifier during token exchange                   â”‚
â”‚                                                              â”‚
â”‚  [View Full Request] [Next Step]                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.5 PKCE in Token Exchange

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 4: Send Code Verifier in Token Request               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Token Request Parameters:                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Parameter            â”‚ Value                      â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ grant_type           â”‚ authorization_code         â”‚     â”‚
â”‚  â”‚ code                 â”‚ SplxlOBeZQQYbYS6WxSbIA    â”‚     â”‚
â”‚  â”‚ code_verifier        â”‚ dBjftJeZ4CVP-mB92K27uh... â”‚     â”‚
â”‚  â”‚                      â”‚ âœ“ Original random string   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚  Server Verification Process:                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 1. Retrieve stored code_challenge                  â”‚    â”‚
â”‚  â”‚    E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM    â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ 2. Receive code_verifier from client               â”‚    â”‚
â”‚  â”‚    dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk    â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ 3. Apply same transformation (SHA-256 + Base64URL) â”‚    â”‚
â”‚  â”‚    dBjftJe... â†’ E9Melhoa2OwvFrEMTJguc...          â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ 4. Compare calculated vs stored challenge          â”‚    â”‚
â”‚  â”‚    Calculated: E9Melhoa2OwvFrEMTJguCHaoeK1t8U... â”‚    â”‚
â”‚  â”‚    Stored:     E9Melhoa2OwvFrEMTJguCHaoeK1t8U... â”‚    â”‚
â”‚  â”‚    Result: âœ“ MATCH                                 â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ 5. Issue tokens (verification successful)          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  âœ“ PKCE Verification: PASSED                                â”‚
â”‚  âœ“ Authorization code bound to original client              â”‚
â”‚  âœ“ Tokens issued safely                                     â”‚
â”‚                                                              â”‚
â”‚  [View Verification Details] [What if No Match?]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.6 PKCE Attack Demonstration

**Side-by-Side Comparison**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WITH PKCE (Secure)          â”‚  WITHOUT PKCE (Vulnerable)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚                              â”‚
â”‚  Authorization Request       â”‚  Authorization Request       â”‚
â”‚  âœ“ code_challenge included   â”‚  âœ— No code_challenge        â”‚
â”‚  âœ“ code_challenge_method=S256â”‚  âœ— No protection            â”‚
â”‚                              â”‚                              â”‚
â”‚  Authorization Code:         â”‚  Authorization Code:         â”‚
â”‚  SplxlOBeZQQYbYS6WxSbIA     â”‚  SplxlOBeZQQYbYS6WxSbIA     â”‚
â”‚  âœ“ Bound to challenge        â”‚  âœ— Not bound to anything    â”‚
â”‚                              â”‚                              â”‚
â”‚  âš ï¸ ATTACKER INTERCEPTS CODE â”‚  âš ï¸ ATTACKER INTERCEPTS CODE â”‚
â”‚                              â”‚                              â”‚
â”‚  Attacker Attempts Exchange: â”‚  Attacker Attempts Exchange: â”‚
â”‚  POST /token                 â”‚  POST /token                 â”‚
â”‚  code: SplxlOB...            â”‚  code: SplxlOB...            â”‚
â”‚  code_verifier: WRONG!       â”‚  (no verifier needed)        â”‚
â”‚                              â”‚                              â”‚
â”‚  Server Response:            â”‚  Server Response:            â”‚
â”‚  âœ— 400 Bad Request           â”‚  âœ“ 200 OK                    â”‚
â”‚  Error: invalid_grant        â”‚  {                           â”‚
â”‚  PKCE verification failed    â”‚    "access_token": "..."     â”‚
â”‚                              â”‚    "refresh_token": "..."    â”‚
â”‚                              â”‚  }                           â”‚
â”‚                              â”‚                              â”‚
â”‚  âœ“ ATTACK PREVENTED          â”‚  âœ— ATTACK SUCCEEDED          â”‚
â”‚  Code cannot be used without â”‚  Attacker obtained victim's  â”‚
â”‚  the original verifier       â”‚  tokens!                     â”‚
â”‚                              â”‚                              â”‚
â”‚  Security Score: 95/100      â”‚  Security Score: 30/100      â”‚
â”‚                              â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Animate Attack Scenario] [View Threat Model]
```

---

## 2. State Parameter and CSRF Visualization

### 2.1 State Parameter Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  State Parameter (CSRF Protection)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Status: âœ“ ENABLED                                          â”‚
â”‚                                                              â”‚
â”‚  Purpose: Prevent Cross-Site Request Forgery (CSRF) attacks â”‚
â”‚           Binds authorization response to original request  â”‚
â”‚                                                              â”‚
â”‚  RFC: 6749 Â§10.12                                           â”‚
â”‚  Security Level: CRITICAL                                   â”‚
â”‚                                                              â”‚
â”‚  [View State Process] [Show CSRF Attack Demo]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 State Generation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: Generate State Parameter                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Random Generation:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Source: Cryptographically secure random number   â”‚    â”‚
â”‚  â”‚          generator (crypto.getRandomValues())      â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  Entropy: 256 bits (32 bytes)                      â”‚    â”‚
â”‚  â”‚  [========================================] 100%    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  State Value (Base64URL encoded):                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  af0ifjsldkj6jF0SLZ9dWxJ8xKL2bVpQtNq               â”‚    â”‚
â”‚  â”‚                                         [Copy]     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  Properties:                                                â”‚
â”‚  â€¢ Length: 32+ characters (recommended)                     â”‚
â”‚  â€¢ Unpredictable: Cryptographically random                  â”‚
â”‚  â€¢ Single-use: One state per authorization request          â”‚
â”‚  â€¢ Unique: Different for each authorization                 â”‚
â”‚                                                              â”‚
â”‚  Session Binding:                                           â”‚
â”‚  âœ“ State stored in user's session                           â”‚
â”‚  âœ“ Tied to current browser session                          â”‚
â”‚  âœ“ Cannot be guessed or reused                              â”‚
â”‚                                                              â”‚
â”‚  Session Storage:                                           â”‚
â”‚  Key: oauth_state                                           â”‚
â”‚  Value: af0ifjsldkj6jF0SLZ9dWxJ8xKL2bVpQtNq                â”‚
â”‚  Expires: After authorization response (single-use)         â”‚
â”‚                                                              â”‚
â”‚  [Regenerate] [View Security Details]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 State in Authorization Request

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: Send State in Authorization Request               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Authorization Request:                                     â”‚
â”‚  GET /auth?                                                 â”‚
â”‚    response_type=code&                                      â”‚
â”‚    client_id=web-app&                                       â”‚
â”‚    state=af0ifjsldkj6jF0SLZ9dWxJ8xKL2bVpQtNq&              â”‚
â”‚    ...                                                      â”‚
â”‚                                                              â”‚
â”‚  State Parameter:                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  af0ifjsldkj6jF0SLZ9dWxJ8xKL2bVpQtNq               â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  Purpose: Ties this authorization to user's sessionâ”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  What Happens:                                              â”‚
â”‚  1. âœ“ Client generates state                                â”‚
â”‚  2. âœ“ Client stores state in session                        â”‚
â”‚  3. âœ“ Client sends state to authorization server            â”‚
â”‚  4. âœ“ Authorization server includes state in response       â”‚
â”‚  5. âœ“ Client validates state matches stored value           â”‚
â”‚                                                              â”‚
â”‚  ğŸ”’ Security: State binds authorization response to the     â”‚
â”‚               user's session, preventing CSRF attacks       â”‚
â”‚                                                              â”‚
â”‚  [View Full Request]                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.4 State Validation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3: Validate State in Authorization Response          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Authorization Response Received:                           â”‚
â”‚  https://localhost:3000/callback?                           â”‚
â”‚    code=SplxlOBeZQQYbYS6WxSbIA&                            â”‚
â”‚    state=af0ifjsldkj6jF0SLZ9dWxJ8xKL2bVpQtNq                â”‚
â”‚                                                              â”‚
â”‚  State Validation Process:                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 1. Extract state from response                     â”‚    â”‚
â”‚  â”‚    Received: af0ifjsldkj6jF0SLZ9dWxJ8xKL2bVpQtNq  â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ 2. Retrieve stored state from session              â”‚    â”‚
â”‚  â”‚    Expected: af0ifjsldkj6jF0SLZ9dWxJ8xKL2bVpQtNq  â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ 3. Compare received vs expected (exact match)      â”‚    â”‚
â”‚  â”‚    Received: af0ifjsldkj6jF0SLZ9dWxJ8xKL2bVpQtNq  â”‚    â”‚
â”‚  â”‚    Expected: af0ifjsldkj6jF0SLZ9dWxJ8xKL2bVpQtNq  â”‚    â”‚
â”‚  â”‚    [========================================] Match â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ 4. Validation Result: âœ“ MATCH                      â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ 5. Clear state from session (single-use)           â”‚    â”‚
â”‚  â”‚    âœ“ State deleted from session                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  âœ“ STATE VALIDATION: PASSED                                 â”‚
â”‚  âœ“ Authorization response is legitimate                     â”‚
â”‚  âœ“ Safe to proceed with token exchange                      â”‚
â”‚                                                              â”‚
â”‚  [View Validation Logic] [What if Mismatch?]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.5 CSRF Attack Demonstration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WITH STATE (Secure)         â”‚  WITHOUT STATE (Vulnerable)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚                              â”‚
â”‚  Attacker's Plan:            â”‚  Attacker's Plan:            â”‚
â”‚  1. Initiate authorization   â”‚  1. Initiate authorization   â”‚
â”‚  2. Intercept response       â”‚  2. Intercept response       â”‚
â”‚  3. Trick victim to use it   â”‚  3. Trick victim to use it   â”‚
â”‚                              â”‚                              â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚                              â”‚                              â”‚
â”‚  1. Attacker starts auth:    â”‚  1. Attacker starts auth:    â”‚
â”‚  state=attacker_state_123    â”‚  (no state parameter)        â”‚
â”‚                              â”‚                              â”‚
â”‚  2. Attacker gets response:  â”‚  2. Attacker gets response:  â”‚
â”‚  code=ABC&state=attacker_123 â”‚  code=ABC                    â”‚
â”‚                              â”‚                              â”‚
â”‚  3. Attacker crafts URL:     â”‚  3. Attacker crafts URL:     â”‚
â”‚  victim.com/callback?        â”‚  victim.com/callback?        â”‚
â”‚    code=ABC&                 â”‚    code=ABC                  â”‚
â”‚    state=attacker_state_123  â”‚                              â”‚
â”‚                              â”‚                              â”‚
â”‚  4. Victim clicks link       â”‚  4. Victim clicks link       â”‚
â”‚                              â”‚                              â”‚
â”‚  5. Victim's session checks: â”‚  5. Victim's session:        â”‚
â”‚  Expected: victim_state_xyz  â”‚  (no state to validate)      â”‚
â”‚  Received: attacker_state_123â”‚  Accepts code=ABC            â”‚
â”‚  âœ— MISMATCH                  â”‚  âœ“ Proceeds with exchange    â”‚
â”‚                              â”‚                              â”‚
â”‚  6. Result:                  â”‚  6. Result:                  â”‚
â”‚  âœ— Authorization rejected    â”‚  âœ“ Tokens issued             â”‚
â”‚  Error: "State mismatch"     â”‚  âœ— VICTIM'S SESSION NOW      â”‚
â”‚  âœ“ ATTACK PREVENTED          â”‚     LINKED TO ATTACKER'S     â”‚
â”‚                              â”‚     AUTHORIZATION!           â”‚
â”‚                              â”‚                              â”‚
â”‚  Victim's session is safe    â”‚  âœ— ATTACK SUCCEEDED          â”‚
â”‚                              â”‚  Attacker controls victim's  â”‚
â”‚                              â”‚  account access              â”‚
â”‚                              â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Animate CSRF Attack] [View Threat Model]
```

---

## 3. JWT Token Visualization

### 3.1 JWT Structure Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JWT Token Structure                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9                       â”‚
â”‚  .                                                           â”‚
â”‚  eyJpc3MiOiJodHRwczovL2F1dGguZXhhbXBsZS5jb20iLCJzdWIiOiJ1c2VyMTIzIiwiYXVkIjoiaHR0cHM6Ly9hcGkuZXhhbXBsZS5jb20iLCJleHAiOjE3MzU3NzYwMDAsImlhdCI6MTczNTc3MjQwMCwic2NvcGUiOiJyZWFkIHdyaXRlIn0
â”‚  .                                                           â”‚
â”‚  dBjftJeZ...signature...                                    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Three Parts Separated by Dots:                       â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ 1. HEADER (Blue)                                     â”‚  â”‚
â”‚  â”‚    Algorithm, token type, key ID                     â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ 2. PAYLOAD (Green)                                   â”‚  â”‚
â”‚  â”‚    Claims about user, token, permissions             â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ 3. SIGNATURE (Orange)                                â”‚  â”‚
â”‚  â”‚    Cryptographic signature                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  Each part is Base64URL encoded                             â”‚
â”‚                                                              â”‚
â”‚  [View Decoded] [Explain Structure] [Validate Token]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 JWT Header Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JWT Header (Algorithm and Metadata)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Encoded (Base64URL):                                       â”‚
â”‚  eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjIwMjQtMDEtMSJ9 â”‚
â”‚                                                              â”‚
â”‚  â–¼ Decoded (JSON):                                          â”‚
â”‚  {                                                           â”‚
â”‚    "alg": "RS256",                                          â”‚
â”‚    "typ": "JWT",                                            â”‚
â”‚    "kid": "2024-01-1"                                       â”‚
â”‚  }                                                           â”‚
â”‚                                                              â”‚
â”‚  â–¼ Claim Explanations:                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Claimâ”‚ Value         â”‚ Description                â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ alg  â”‚ RS256         â”‚ RSA signature with SHA-256 â”‚     â”‚
â”‚  â”‚      â”‚               â”‚ â„¹ï¸ Asymmetric algorithm     â”‚     â”‚
â”‚  â”‚      â”‚               â”‚ â„¹ï¸ Private key signs        â”‚     â”‚
â”‚  â”‚      â”‚               â”‚ â„¹ï¸ Public key verifies      â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ typ  â”‚ JWT           â”‚ Token type (always "JWT")  â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ kid  â”‚ 2024-01-1     â”‚ Key identifier             â”‚     â”‚
â”‚  â”‚      â”‚               â”‚ â„¹ï¸ Which public key to use  â”‚     â”‚
â”‚  â”‚      â”‚               â”‚ â„¹ï¸ Retrieved from JWKS      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚  ğŸ”’ Security: Algorithm specifies how token is signed       â”‚
â”‚              Never accept alg=none (unsigned tokens)        â”‚
â”‚                                                              â”‚
â”‚  [View Supported Algorithms] [View Key Details]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 JWT Payload Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JWT Payload (Claims)                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â–¼ Standard Claims:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Claimâ”‚ Value                â”‚ Validation   â”‚ RFC Â§    â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ iss  â”‚ https://auth.ex.com  â”‚ âœ“ Valid      â”‚ 7519Â§4.1.1â”‚ â”‚
â”‚  â”‚      â”‚ (Issuer)             â”‚ Matches exp. â”‚          â”‚ â”‚
â”‚  â”‚      â”‚ â„¹ï¸ Who issued token   â”‚              â”‚          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ sub  â”‚ user123              â”‚ -            â”‚ 7519Â§4.1.2â”‚ â”‚
â”‚  â”‚      â”‚ (Subject)            â”‚ User ID      â”‚          â”‚ â”‚
â”‚  â”‚      â”‚ â„¹ï¸ Who token is for   â”‚              â”‚          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ aud  â”‚ https://api.ex.com   â”‚ âœ“ Valid      â”‚ 7519Â§4.1.3â”‚ â”‚
â”‚  â”‚      â”‚ (Audience)           â”‚ Matches API  â”‚          â”‚ â”‚
â”‚  â”‚      â”‚ â„¹ï¸ Who should accept  â”‚              â”‚          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ exp  â”‚ 1735776000           â”‚ âœ“ Valid      â”‚ 7519Â§4.1.4â”‚ â”‚
â”‚  â”‚      â”‚ 2024-12-31 12:00 UTC â”‚ Not expired  â”‚          â”‚ â”‚
â”‚  â”‚      â”‚ â± 23m 45s remaining  â”‚ â± Live timer â”‚          â”‚ â”‚
â”‚  â”‚      â”‚ â„¹ï¸ Expiration time    â”‚              â”‚          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ iat  â”‚ 1735772400           â”‚ âœ“ Valid      â”‚ 7519Â§4.1.6â”‚ â”‚
â”‚  â”‚      â”‚ 2024-12-31 11:00 UTC â”‚ Recent       â”‚          â”‚ â”‚
â”‚  â”‚      â”‚ â„¹ï¸ Issued at time     â”‚              â”‚          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ nbf  â”‚ 1735772400           â”‚ âœ“ Valid      â”‚ 7519Â§4.1.5â”‚ â”‚
â”‚  â”‚      â”‚ 2024-12-31 11:00 UTC â”‚ Already validâ”‚          â”‚ â”‚
â”‚  â”‚      â”‚ â„¹ï¸ Not before time    â”‚              â”‚          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  â–¼ OAuth2/OIDC Claims:                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ scopeâ”‚ openid profile email â”‚ âœ“ Present    â”‚ 6749Â§3.3 â”‚ â”‚
â”‚  â”‚      â”‚ â„¹ï¸ Granted permissionsâ”‚              â”‚          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ azp  â”‚ web-app              â”‚ -            â”‚ OIDCÂ§2   â”‚ â”‚
â”‚  â”‚      â”‚ â„¹ï¸ Authorized party   â”‚              â”‚          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  â–¼ Custom Claims:                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ department   â”‚ Engineering                           â”‚  â”‚
â”‚  â”‚ employee_id  â”‚ EMP-12345                             â”‚  â”‚
â”‚  â”‚ roles        â”‚ ["admin", "developer"]                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  [View All Claims] [Explain Each Claim]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 JWT Signature Verification

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JWT Signature Verification                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Signature (Base64URL):                                     â”‚
â”‚  dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk...            â”‚
â”‚                                                              â”‚
â”‚  Verification Process:                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Step 1: Retrieve Public Key                        â”‚    â”‚
â”‚  â”‚   â€¢ Key ID (kid): 2024-01-1                        â”‚    â”‚
â”‚  â”‚   â€¢ Fetch JWKS from:                               â”‚    â”‚
â”‚  â”‚     https://auth.example.com/.well-known/jwks.json â”‚    â”‚
â”‚  â”‚   â€¢ Find key with matching kid                     â”‚    â”‚
â”‚  â”‚   âœ“ Public key retrieved                           â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ Step 2: Reconstruct Signing Input                  â”‚    â”‚
â”‚  â”‚   â€¢ Combine header and payload:                    â”‚    â”‚
â”‚  â”‚     base64url(header) + "." + base64url(payload)   â”‚    â”‚
â”‚  â”‚   â€¢ Result: eyJhbGc...eyJpc3M...                   â”‚    â”‚
â”‚  â”‚   âœ“ Signing input reconstructed                    â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ Step 3: Verify Signature                           â”‚    â”‚
â”‚  â”‚   â€¢ Algorithm: RS256 (RSA-SHA256)                  â”‚    â”‚
â”‚  â”‚   â€¢ Public key: Retrieved from JWKS                â”‚    â”‚
â”‚  â”‚   â€¢ Signature: dBjftJeZ4CVP...                     â”‚    â”‚
â”‚  â”‚   â€¢ Cryptographic verification...                  â”‚    â”‚
â”‚  â”‚   âœ“ Signature is VALID                             â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ Step 4: Verify Integrity                           â”‚    â”‚
â”‚  â”‚   â€¢ Token has not been tampered with               â”‚    â”‚
â”‚  â”‚   â€¢ Header and payload are authentic               â”‚    â”‚
â”‚  â”‚   â€¢ Issued by trusted authorization server         â”‚    â”‚
â”‚  â”‚   âœ“ Token integrity confirmed                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚  Overall Status: âœ“ SIGNATURE VALID                          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚                                                              â”‚
â”‚  ğŸ”’ Security: Valid signature proves token was issued by    â”‚
â”‚              trusted authorization server and not modified  â”‚
â”‚                                                              â”‚
â”‚  [View JWKS] [View Public Key Details] [Verify Again]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.5 Complete JWT Validation Checklist

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JWT Token Validation Checklist                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Validation Steps:                                          â”‚
â”‚  â”Œâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚#â”‚ Check                                  â”‚ Status   â”‚   â”‚
â”‚  â”œâ”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚1â”‚ Token format (three parts)             â”‚ âœ“ Pass   â”‚   â”‚
â”‚  â”‚2â”‚ Base64URL decoding                     â”‚ âœ“ Pass   â”‚   â”‚
â”‚  â”‚3â”‚ JSON parsing                           â”‚ âœ“ Pass   â”‚   â”‚
â”‚  â”‚4â”‚ Algorithm check (no alg=none)          â”‚ âœ“ Pass   â”‚   â”‚
â”‚  â”‚5â”‚ Algorithm matches expected             â”‚ âœ“ Pass   â”‚   â”‚
â”‚  â”‚6â”‚ Signature verification                 â”‚ âœ“ Pass   â”‚   â”‚
â”‚  â”‚7â”‚ Expiration (exp claim)                 â”‚ âœ“ Pass   â”‚   â”‚
â”‚  â”‚8â”‚ Not before (nbf claim)                 â”‚ âœ“ Pass   â”‚   â”‚
â”‚  â”‚9â”‚ Issuer (iss claim)                     â”‚ âœ“ Pass   â”‚   â”‚
â”‚  â”‚10â”‚ Audience (aud claim)                   â”‚ âœ“ Pass   â”‚   â”‚
â”‚  â”‚11â”‚ Issued at time (iat claim)             â”‚ âœ“ Pass   â”‚   â”‚
â”‚  â”‚12â”‚ Required scopes present                â”‚ âœ“ Pass   â”‚   â”‚
â”‚  â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚  Overall Validation: âœ“ TOKEN IS VALID AND TRUSTED           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚                                                              â”‚
â”‚  Token can be used for API authorization                    â”‚
â”‚  Expires in: 23 minutes 15 seconds                          â”‚
â”‚                                                              â”‚
â”‚  [View Failed Validation Examples] [Export Report]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. ID Token (OIDC) Visualization

### 4.1 ID Token vs Access Token

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ID Token vs Access Token                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ID Token                 â”‚ Access Token             â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ Purpose: AUTHENTICATION  â”‚ Purpose: AUTHORIZATION   â”‚   â”‚
â”‚  â”‚ "Who is the user?"       â”‚ "What can they do?"      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ For: Client application  â”‚ For: Resource server     â”‚   â”‚
â”‚  â”‚ Consumed by: Client      â”‚ Consumed by: API         â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ Contains: User identity  â”‚ Contains: Permissions    â”‚   â”‚
â”‚  â”‚ - Name, email, etc.      â”‚ - Scopes, roles          â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ Sent to: Client only     â”‚ Sent to: Resource server â”‚   â”‚
â”‚  â”‚ âš ï¸ Never send to API     â”‚ âœ“ Send with API requests â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ Format: Always JWT       â”‚ Format: JWT or opaque    â”‚   â”‚
â”‚  â”‚ Validated by: Client     â”‚ Validated by: API        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚  âš ï¸ CRITICAL: Do NOT use ID token for API authorization!    â”‚
â”‚                                                              â”‚
â”‚  [Learn More] [View Examples]                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ID Token Specific Claims

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ID Token Claims (OIDC-Specific)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â–¼ Authentication Claims:                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Claim     â”‚ Value            â”‚ Description         â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ nonce     â”‚ n-0S6_WzA2Mj     â”‚ Replay protection   â”‚    â”‚
â”‚  â”‚           â”‚                  â”‚ â„¹ï¸ Binds to session  â”‚    â”‚
â”‚  â”‚           â”‚                  â”‚ âœ“ Matches request   â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ auth_time â”‚ 1735772350       â”‚ Authentication time â”‚    â”‚
â”‚  â”‚           â”‚ (11:05:50 UTC)   â”‚ When user logged in â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ acr       â”‚ urn:mace:incommonâ”‚ Auth context class  â”‚    â”‚
â”‚           â”‚ :iap:silver      â”‚ Auth strength level â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚ amr       â”‚ ["pwd", "mfa"]   â”‚ Auth methods used   â”‚    â”‚
â”‚  â”‚           â”‚                  â”‚ Password + MFA      â”‚    â”‚
â”‚  â”‚ at_hash   â”‚ 77QmUPtjPfzWtF2Aâ”‚ Access token hash   â”‚    â”‚
â”‚  â”‚           â”‚                  â”‚ â„¹ï¸ Binds to AT       â”‚    â”‚
â”‚  â”‚           â”‚                  â”‚ âœ“ Valid             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â–¼ User Profile Claims:                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ name         â”‚ Alice Anderson                        â”‚  â”‚
â”‚  â”‚ email        â”‚ alice@example.com                     â”‚  â”‚
â”‚  â”‚ email_verifiedâ”‚ true                                  â”‚  â”‚
â”‚  â”‚ picture      â”‚ https://example.com/avatar.jpg       â”‚  â”‚
â”‚  â”‚ preferred_usernameâ”‚ alice                             â”‚  â”‚
â”‚  â”‚ updated_at   â”‚ 1735600000                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  [View All Claims] [Validate at_hash]                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 ID Token Validation (12 Steps)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ID Token Validation (OIDC Core Â§3.1.3.7)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚#â”‚ Validation Step                          â”‚ Status   â”‚ â”‚
â”‚  â”œâ”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚1â”‚ iss matches expected issuer              â”‚ âœ“ Pass   â”‚ â”‚
â”‚  â”‚2â”‚ aud contains client_id                   â”‚ âœ“ Pass   â”‚ â”‚
â”‚  â”‚3â”‚ If multiple aud, azp must be present     â”‚ âœ“ Pass   â”‚ â”‚
â”‚  â”‚4â”‚ If azp, it must equal client_id          â”‚ âœ“ Pass   â”‚ â”‚
â”‚  â”‚5â”‚ Signature valid (algorithm check)        â”‚ âœ“ Pass   â”‚ â”‚
â”‚  â”‚6â”‚ exp (expiration) not passed              â”‚ âœ“ Pass   â”‚ â”‚
â”‚  â”‚7â”‚ iat (issued at) not too far in past      â”‚ âœ“ Pass   â”‚ â”‚
â”‚  â”‚8â”‚ nonce matches request nonce              â”‚ âœ“ Pass   â”‚ â”‚
â”‚  â”‚9â”‚ acr satisfies requirements (if req)      â”‚ âœ“ Pass   â”‚ â”‚
â”‚  â”‚10â”‚ auth_time satisfies max_age (if req)     â”‚ âœ“ Pass   â”‚ â”‚
â”‚  â”‚11â”‚ at_hash matches access token (if present)â”‚ âœ“ Pass   â”‚ â”‚
â”‚  â”‚12â”‚ c_hash matches code (Hybrid flow only)   â”‚ N/A      â”‚ â”‚
â”‚  â””â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚  Overall Validation: âœ“ ID TOKEN IS VALID                    â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚                                                              â”‚
â”‚  User authenticated successfully                            â”‚
â”‚  Identity confirmed                                         â”‚
â”‚                                                              â”‚
â”‚  [View at_hash Calculation] [View Nonce Validation]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 at_hash Validation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  at_hash Validation (Token Binding)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Purpose: Binds ID token to access token                    â”‚
â”‚           Prevents access token substitution                â”‚
â”‚                                                              â”‚
â”‚  Calculation Process:                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Step 1: Take access token                          â”‚    â”‚
â”‚  â”‚   eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...         â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ Step 2: Hash with same algorithm as signature      â”‚    â”‚
â”‚  â”‚   SHA-256(access_token)                            â”‚    â”‚
â”‚  â”‚   Result: df8a456b3c...                            â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ Step 3: Take left half of hash                     â”‚    â”‚
â”‚  â”‚   First 128 bits (16 bytes)                        â”‚    â”‚
â”‚  â”‚   df8a456b3c4d... (first half)                     â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ Step 4: Base64URL encode                           â”‚    â”‚
â”‚  â”‚   Result: 34KV6p4BuzmYbVj9h5                       â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚ Step 5: Compare with at_hash in ID token           â”‚    â”‚
â”‚  â”‚   Calculated: 34KV6p4BuzmYbVj9h5                   â”‚    â”‚
â”‚  â”‚   ID token:   34KV6p4BuzmYbVj9h5                   â”‚    â”‚
â”‚  â”‚   Result: âœ“ MATCH                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  âœ“ at_hash validation: PASSED                               â”‚
â”‚  âœ“ ID token is bound to this access token                   â”‚
â”‚  âœ“ Access token has not been substituted                    â”‚
â”‚                                                              â”‚
â”‚  ğŸ”’ Security: Prevents attacker from using stolen ID token  â”‚
â”‚              with different access token                    â”‚
â”‚                                                              â”‚
â”‚  [View Calculation Details] [Show Attack Scenario]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Redirect URI Validation Visualization

### 5.1 Registered URIs

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Registered Redirect URIs (Client Configuration)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Client: web-app                                            â”‚
â”‚                                                              â”‚
â”‚  Registered Redirect URIs:                                  â”‚
â”‚  1. https://localhost:3000/callback                         â”‚
â”‚  2. https://localhost:3000/oauth2/callback                  â”‚
â”‚  3. https://app.example.com/callback                        â”‚
â”‚                                                              â”‚
â”‚  âš ï¸ Only exact matches allowed                              â”‚
â”‚  â„¹ï¸ NO wildcards, NO pattern matching                       â”‚
â”‚  â„¹ï¸ Registered during client creation                       â”‚
â”‚                                                              â”‚
â”‚  Validation Rules:                                          â”‚
â”‚  âœ“ Exact string match (case-sensitive)                      â”‚
â”‚  âœ“ Scheme (https://) must match                             â”‚
â”‚  âœ“ Domain must match                                        â”‚
â”‚  âœ“ Port must match (if specified)                           â”‚
â”‚  âœ“ Path must match exactly                                  â”‚
â”‚  âœ— Query parameters not allowed in registration             â”‚
â”‚  âœ— Fragment not allowed in registration                     â”‚
â”‚                                                              â”‚
â”‚  [View Validation Logic] [Test URI]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 URI Validation Process

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Redirect URI Validation                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Requested URI:                                             â”‚
â”‚  https://localhost:3000/callback                            â”‚
â”‚                                                              â”‚
â”‚  Validation Process:                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 1. Extract redirect_uri from request                â”‚    â”‚
â”‚  â”‚    https://localhost:3000/callback                   â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚ 2. Normalize URI (remove trailing slash, etc.)      â”‚    â”‚
â”‚  â”‚    https://localhost:3000/callback                   â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚ 3. Compare with registered URIs (exact match)       â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚    Registered #1: https://localhost:3000/callback   â”‚    â”‚
â”‚  â”‚    Requested:     https://localhost:3000/callback   â”‚    â”‚
â”‚  â”‚    [=======================================] MATCH   â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚ 4. Match found? âœ“ YES                               â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚ 5. Authorization proceeds                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  âœ“ VALIDATION: PASSED                                       â”‚
â”‚  âœ“ URI is registered                                        â”‚
â”‚  âœ“ Safe to redirect                                         â”‚
â”‚                                                              â”‚
â”‚  [View Comparison Details]                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 Open Redirect Attack Demo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SECURE: Exact Match         â”‚  VULNERABLE: Prefix Match    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚                              â”‚
â”‚  Registered:                 â”‚  Registered:                 â”‚
â”‚  https://app.example.com/cb  â”‚  https://app.example.com/cb  â”‚
â”‚                              â”‚  (with wildcard suffix)      â”‚
â”‚                              â”‚                              â”‚
â”‚  Attacker requests:          â”‚  Attacker requests:          â”‚
â”‚  https://app.example.com/    â”‚  https://app.example.com/    â”‚
â”‚    callback.evil.com         â”‚    callback.evil.com         â”‚
â”‚                              â”‚                              â”‚
â”‚  Validation:                 â”‚  Validation:                 â”‚
â”‚  â€¢ Requested: ...callback.   â”‚  â€¢ Requested: ...callback.   â”‚
â”‚               evil.com       â”‚               evil.com       â”‚
â”‚  â€¢ Registered: ...           â”‚  â€¢ Registered: ...           â”‚
â”‚                /callback     â”‚                /callback*    â”‚
â”‚  â€¢ Match: âœ— NO               â”‚  â€¢ Prefix match: âœ“ YES!      â”‚
â”‚                              â”‚                              â”‚
â”‚  Result:                     â”‚  Result:                     â”‚
â”‚  âœ— Request REJECTED          â”‚  âœ“ Request ACCEPTED          â”‚
â”‚  Error shown to user         â”‚  Code sent to evil.com!      â”‚
â”‚  NO redirect                 â”‚  âœ— OPEN REDIRECT             â”‚
â”‚                              â”‚                              â”‚
â”‚  âœ“ ATTACK PREVENTED          â”‚  âœ— ATTACK SUCCEEDED          â”‚
â”‚  Authorization code safe     â”‚  Authorization code leaked   â”‚
â”‚                              â”‚                              â”‚
â”‚  Security Score: 100/100     â”‚  Security Score: 20/100      â”‚
â”‚                              â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[Animate Attack] [View Threat Model] [Test Your URI]
```

---

## Document Metadata

| Property | Value |
|----------|-------|
| **Version** | 1.0.0 |
| **Part** | 3 of 6 (Security Features) |
| **Related Docs** | PKCE, state, JWT, redirect URI specs |
| **Completeness** | All major security mechanisms covered |

---

**Next**: See `visualization-debugging-features.md` for debugging and error handling visualizations.
